# 11. 대규모 데이터 처리를 지탱하는 서버/인프라 입문

# 29. 엔터프라이즈 vs 웹 서비스 - 응용범위로 보는 차이

## **웹 서비스의 특징 - 엔터프라이즈와 비교**

![image.png](attachment:ff5a672a-6e61-4b1d-a29b-a97059943cf5:image.png)

- 트래픽
  - 엔터프라이즈에 대규모 트래픽이 일어날 일은 많이 없지만,
    웹 서비스에서는 대규모 트래픽이 발생할 가능성이 있다.
- 성장성
  - 엔터프라이즈는 실제 비즈니스와 연관되어 있어서 급격하게 성장하지는 않는다.
  - 웹 서비스와 같은 경우는 폭팔적으로 성장이 가능하다.
- 신뢰성
  - 엔터프라이즈는 장애가 발생해서 데이터가 유실되거나 할 경우,
    (손해 배상 청구를 받게 되거나 사람 목숨을 구하지 못하는 등) 심각한 사태가 발생 할 수 있기 때문에
    높은 신뢰성이 요구된다.
  - 웹 서비스는 인명이나 돈과 깊게 관련 없는 경우가 더 많기 때문에 그렇게 높은 신뢰성이 요구되지는 않는다.
- 트랜잭션 - 신뢰성과 비슷한 이야기지만, 좀 더 DB 관점이다.
  - 엔터프라이즈는 데이터의 정합성을 정확히 유지해야 한다. → 그래서 트랜잭션을 사용한다.
    - ex) 계좌이체 시 양쪽 계좌간 부정합이 발생하면 금전적인 손해가 발생한다.
  - 웹 서비스는 일시적으로 정합성이 일치하지 않아도 큰 문제가 발생하지 않는다.
    - ex) 블로그 글 작성 후 게시되기까지 시간지연이 발생해도
      크게 문제되지 않는다.

## **웹 서비스의 인프라 - 중요시되는 세 가지 포인트**

1. 저비용 고효율
  - 항상 trade-off가 있기 때문에 저비용을 고수하기 위해서는 희생되는 무언가가 있다.
  - 이때100% 신뢰성을 목표로 하지 말자!
    - 많은 비용을 지불한다면 높은 신뢰성을 가질 수 있겠지만
      비용을 낮춰서 효율을 추구하는 방향을 택한다.
2. 확장성이나 응답성 등의 설계
  - 서비스의 성장속도를 모르거나 UX를 위해 응답성이 중요한 경우도 있다.
    - 이때 100% 신뢰성을 추구하기 보다  장래를 위해 확장을 고려한 설계를 한다.
    - 또한 대부분의 시간에 양호한 상태의 응답이 이루어질 수 있도록 하는 등의
      기술적으로 중점을 둔 설계가 중요하다.
3. 바뀌는 서비스 사양에 유연하게 대응할 수 있어야 한다.
  - 변화가 빠른 웹 시장에서는 변화에 발빠르게 대응이 가능해야 한다.
    → 개발 속도를 중시한 인프라로 구정하는 것도 중요하다.
    - 배포를 간편하게 구성한다.
    - 배포할 때 처리중인 요청에 영향이 없도록 한다.
    - 배포한 코드에 문제 발생 시 즉각 롤백한다.


# 30. 클라우드 vs 자체구축 인프라

## **클라우드의 장단점**

- 장점
  - 저가로 사용하면서 확장해갈 수 있다. = `확장성`
    - 🧑‍🔧 *서버리스(Serverless)*, *오토스케일링(자동 확장)*, *스팟 인스턴스* 같은 것이 더 보편화되면서
      "필요한 만큼 쓰고, 필요한 만큼만 돈 내는" 모델이 더 강화되었다.
    - 🧑‍🔧  ⚠️ 저가 X →  잘 설계하면 싸게 쓸 수 있지만, 방심하면 비용 폭탄 맞을 수 있다.
- 단점
  - Amazon EC2 등의 각 클라우드 서비스마다의 독자적인 사양에 대응해야한다.
    - 🧑‍🔧  AWS, Azure, GCP, Oracle Cloud, Alibaba Cloud 등등 모두 세부적인 서비스 명세가 달라서, 특정 클라우드에 종속(Lock-in)되는 문제는 여전히 존재함
      → 그래서 요즘은 `*멀티 클라우드*`나 `*클라우드 추상화 플랫폼*` 을 쓰는 경우도 많아졌다고 한다.
  - 호스트 사양이 획일적이라서
    메모리를 대량으로 늘리려고 해도 어느 정도 이상은 늘릴 수 없다거나
    I/O 성능이 그다지 빠르지 않은 호스트 밖에 없다.
    - 🧑‍🔧⚠️  요즘은 많이 개선되서 초고성능 인스턴스도 제공한다.
      다만, 클라우드 특유의 가상화 레이어 때문에 로컬 머신에 비해 성능이 덜 나오는 경우가 있다고 함.
  - 로드벨런서의 알고리즘 사양이 어떻게 되어 있는지,
    한계에 가까워 졌을 때 어떻게 동작하는 지 등 아직 잘 모르는 부분이다.
    - 🧑‍🔧 요즘은 많이 투명해졌다**.**
      - AWS ALB, NLB, GCP Load Balancer 등은 최대 처리량, 동시 연결 수, 동작 방식(라우팅 알고리즘) 등을 문서화해놓았다고 .
      - 물론, 여전히 세부 동작(특히 장애 상황에서의 Failover 처리)까지 100% 공개하는 건 아니다.

        → 그래서 미션 크리티컬한 서비스에서는 직접 실험해보는 걸 권장

  - 그냥 노드가 죽어버릴 수도 있다
    - 🧑‍🔧 맞는 말이다. 그래서 클라우드 인프라는 본질적으로 "노드가 죽는 걸 감안하고 시스템을 설계해야" 한다.
      → 그래서 **`탄력성(Resiliency)`**, **`Self-healing architecture`** 같은 개념이 중요해졌다.

## **자체구축 인프라의 장점**

- 하드웨어 구성을 유연하게 할 수 있다.
  - 클라우드 컴퓨팅의 경우 사양에 상한선이 있어서 그 부분 제어를 자유롭게 할 수 없지만
    자체 구축인 경우 ssd를 도입하여 I/O 성능을 올리는 등 커스텀이 가능하다.
- 서비스로부터 요청에 유연하게 대응할 수 있다.
  - 대수를 늘리는 것 뿐만 아니라 아니라
    네트워크적으로 가까운 구성을 갖추고 싶다거나
    데이터를 대량으로 쌓을 수 있도록 하는 등의 요청에 대응 할 수 있다.
- 병목현상을 제어할 수 있다.
  - 병목 현상이 있을때 클라우드 컴퓨팅 회사의 사양이나 알고리즘에 의존적을 수 밖에 없지만
    자체구축이면 자체적으로 제어가 가능하다.

## **자체구축 인프라와 수직통합 모델**

- 수직통합 모델이란?
  - 물리적 계층부터 서비스 설계까지 모든 것을 한 회사에세 구축하는 모델
  - ex) Google, Amazon
- 수평분산 모델이란?
  - 각 계층마다 다른 기업이 시스템으로 제공하는 것
  - ex) Microsoft와 같은 OS와 오피스군과 같은 일부 애플리케이션에 특화된 기업