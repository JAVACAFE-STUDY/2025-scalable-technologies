# 05. 대규모 데이터 처리 실전 입문

이번장부터는 대규모 데이터를 이용하는 어플리케이션을 개발할때의 급소를 알아본다.

지금까지는 대량의 데이터가 있더라도
국소성을 발견하고 그에 맞게 시스템을 변경하는 방식으로 해결책을 제시했다.

하지만 국소성 없이 광범위한 데이터에 접근해야 하는 경우에는 어떻게 해야할까?
( 통계처리, 전문검색, 데이터마이닝 등등 )

이번장에서는
처리할 수 없는 대규모 데이터를 대상으로 계산하고자 할 경우 어떠한 대책이 있을지 살펴본다.

# 14. 용도 특화형 인덱싱

### **인덱스와 시스템 구성 - RDBMS가 한계를 보일 때**

지나치게 많은 대규모 데이터를 다루는 경우 (전문검색,데이터마이닝,통계 등등) RDBMS로는 한계가 있다.
그렇다면 해결 방법은 ? → RDBMS를 사용하지 말까??  NO!

일단 아래와 같은 해결방법을 들 수 있다.

- 배치 처리로 RDBMS에서 대량의 데이터를 추출한다
- 별도의 인덱스 서버를 만들고 데이터를 보관
- WAS에서 인덱스 서버에  RPC(Remote Procedure Call)등으로 액세스 하도록 처리

**RPC, 웹 API**

하테나 북마크 시스템을 예시로 하면 아래와 같이 구현할 수 있다.

![image.png](attachment:fa8a748c-04eb-415b-a255-0d81e1f493dc:image.png)

1. DB 가 정기적으로 데이터를 추출해서 인덱스 서버로 넘긴다.
2. 인덱스 서버에서 검색용 인덱스를 만든다.
3. WAS 서버에서 인덱스를 가지고 있는 인덱스 서버에 RPC로 액세스 한다.



웹 API를 통해 JSON을 반환하도록 할 수 있다.

![image.png](attachment:336ae103-b600-4609-bf64-11db573d80c7:image.png)

1. 인덱스 서버에 무언가를 검색해서 JSON을 반환하는 어플리케이션을 만든다.
2. WAS에서는 웹 API를 통해 검색 후 JSON을 반환 받는다.

❓ WAS에 직접 인덱스를 저장하지 않는 이유는?
- WAS의 용량이 주로 충분하지 않기 때문이다.
- 대용량 인덱스 데이터를 여러 프로세스에서 공유하는 것은 적합하지 않다.
  - 여러개의 WAS를 두었을 때 각각 그런 대용량 인덱스를 가지고 있는 것은 좋지 않다.

→ 따라서 대규모 인덱스용 서버를 따로 둔다.

### 용도특화형 인덱싱 - 튜닝한 데이터 구조 사용하기
뭔가 특정 목적만으로 사용하고자 할 때 그에 맞춰서 튜닝한 데이터 구조를 사용하면 압도적으로 빠르다.
이것을 `용도특화형 인덱싱` 이라고 한다.

- ex) 검색에서의 역 인덱스
  - 자연어 처리를 미리 해두고 인덱스를 만들어두면
    데이터를 전부 순회하지 않아도 검색을 처리할 수 있기 때문에
    속도 개선을 할 수 있음

**사용사례**
- 하테나 키워드 링크
- 하테나 북마크의 텍스트 분류기
- 전문 검색 엔진을 만들어서 사용
  - 대량의 데이터를 검색하고자 할 때 용이

## 15. 이론과 실전 양쪽과의 싸움

대규모 웹 어플리케이션을 개발/운영하려고 할 때,
한쪽으로 치우치지 말고 “이론”과 “실전” 사이의 균형을 잘 맞추어야 한다.

### ❗예를 들어

‘RDBMS에서 Join을 사용하지 말라는 것”은  Bad Knowhow이다.

“RDB를 사용하면서 JOIN을 쓰지 않는다?”
→  RDBMS의 본질적인 개념을 부정하면서 RDB를 사용하는 것으로 보인다.

이론적으로는 말이 안된다.

이것은 “실전”에서 마주한 노하우 같은 것이다.

대규모 어플리케이션을 개발.운영하면서 이론과 실전의 적절한 균형이 매우 중요하다.

- 너무 이론만 추구해도 막상 구현하려고 했을 때 잘 안되는 경우가 있고
- 이론을 모른다면 엄청난 규모의 데이터에서 문제가 생겼을 때
  실전 노하우만으로는 해결되지 않는 때가 많아진다.

### 또 하나 중요한 것!

> 💡실현하고자 하는 일을 컴퓨터의 문제로 전환해서 해결책을 찾을 수 있어야 한다.  
여기에는 이론적 지식이 중요하다.


❗예를들어,

“키워드로 링크하고 싶다” 라는 “실현하고자 하는 것”만 머리속에 있다면
어떤 방법이 좋은 방법인지 알기 힘들다.

이론적인 알고리즘 지식이 있다면
어떤 알고리즘을 사용해야 효율적으로 해결이 가능할지 떠올릴 수 있다.